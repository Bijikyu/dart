#include "seq/dirichlet.h"
#include "stemloc/sldefaults.h"
#include "stemloc/superpair.h"
#include "stemloc/superstem.h"
#include "stemloc/quickalign.h"
#include "stemloc/slkeywords.h"

// number of comparison parameterisations for Stemloc_gramset
#define N_CMP_PARAMS 4

// default Laplace pseudocounts
#define STEMLOC_DEFAULT_DIRICHLET_PSEUDOCOUNT 0.1

void Stemloc_defaults::init_quickstem_params (Telegraph_PScores_adaptor& fold_tgio)
{
  init_flat_params (fold_tgio);
}

void Stemloc_defaults::init_quickalign_params (Telegraph_PScores_adaptor& align_tgio)
{
  // commented out init_flat_params because it was corrupting the local/global const-bgroup; IH, 4/4/08
  // init_flat_params (align_tgio);  // catch anything not assigned below
  align_tgio.read_from_string ("match[0]=>0.855;match[1]=>3.103;match[2]=>1.595;insert[0]=>1.635;insert[1]=>0.560;insert[2]=>12.488;insert[3]=>100.000;gap[0]=>1.414;gap[1]=>5.362;gap[2]=>0.735;gapx[0]=>0.051;gapx[1]=>4.834;qsubA[A]=>1.072;qsubA[C]=>2.990;qsubA[G]=>2.411;qsubA[U]=>2.245;qsubC[A]=>2.303;qsubC[C]=>1.638;qsubC[G]=>2.521;qsubC[U]=>1.726;qsubG[A]=>2.012;qsubG[C]=>2.843;qsubG[G]=>1.280;qsubG[U]=>2.313;qsubU[A]=>2.128;qsubU[C]=>2.342;qsubU[G]=>2.483;qsubU[U]=>1.339;match2[0]=>0.248;match2[1]=>4.353;match2[2]=>3.193;insert2[0]=>1.105;insert2[1]=>0.908;insert2[2]=>8.742;insert2[3]=>100.000;gap2[0]=>0.778;gap2[1]=>4.000;gap2[2]=>1.495;gapx2[0]=>0.146;gapx2[1]=>3.371;qsubA2[A]=>0.627;qsubA2[C]=>3.595;qsubA2[G]=>2.744;qsubA2[U]=>3.050;qsubC2[A]=>3.383;qsubC2[C]=>0.687;qsubC2[G]=>3.294;qsubC2[U]=>2.464;qsubG2[A]=>2.806;qsubG2[C]=>3.638;qsubG2[G]=>0.574;qsubG2[U]=>3.248;qsubU2[A]=>2.932;qsubU2[C]=>2.395;qsubU2[G]=>3.152;qsubU2[U]=>0.819;match3[0]=>0.152;match3[1]=>5.628;match3[2]=>3.644;insert3[0]=>1.188;insert3[1]=>0.872;insert3[2]=>6.050;insert3[3]=>100.000;gap3[0]=>0.781;gap3[1]=>3.435;gap3[2]=>1.618;gapx3[0]=>0.402;gapx3[1]=>2.037;qsubA3[A]=>0.245;qsubA3[C]=>5.050;qsubA3[G]=>3.664;qsubA3[U]=>4.400;qsubC3[A]=>5.160;qsubC3[C]=>0.289;qsubC3[G]=>4.920;qsubC3[U]=>3.048;qsubG3[A]=>3.799;qsubG3[C]=>4.893;qsubG3[G]=>0.210;qsubG3[U]=>5.040;qsubU3[A]=>4.559;qsubU3[C]=>3.073;qsubU3[G]=>4.657;qsubU3[U]=>0.323;match4[0]=>0.037;match4[1]=>7.274;match4[2]=>5.717;insert4[0]=>0.824;insert4[1]=>1.230;insert4[2]=>6.772;insert4[3]=>100.000;gap4[0]=>2.011;gap4[1]=>3.956;gap4[2]=>0.540;gapx4[0]=>0.420;gapx4[1]=>1.982;qsubA4[A]=>0.063;qsubA4[C]=>8.448;qsubA4[G]=>5.126;qsubA4[U]=>6.456;qsubC4[A]=>7.893;qsubC4[C]=>0.036;qsubC4[G]=>9.145;qsubC4[U]=>5.706;qsubG4[A]=>5.449;qsubG4[C]=>9.454;qsubG4[G]=>0.037;qsubG4[U]=>9.919;qsubU4[A]=>6.250;qsubU4[C]=>5.527;qsubU4[G]=>9.572;qsubU4[U]=>0.053;", true, true);
}

void Stemloc_defaults::init_stempair_params (Telegraph_PScores_adaptor& cmp_tgio)
{
  init_flat_params (cmp_tgio);
}

void Stemloc_defaults::init_superpair_params (Telegraph_PScores_adaptor& cmp_tgio)
{
  init_flat_params (cmp_tgio);  // catch anything not assigned below
  cmp_tgio.read_from_string ("nullEmit[A]=>1.832;nullEmit[C]=>2.304;nullEmit[G]=>2.021;nullEmit[U]=>1.885;nullExtend[N]=>16.940;nullExtend[Y]=>0.000;startInStem[N]=>0.198;startInStem[Y]=>2.961;loopExtend[N]=>2.044;loopExtend[Y]=>0.400;loopGapOpen[N]=>0.239;loopGapOpen[Y]=>2.711;loopGapExtend[N]=>2.171;loopGapExtend[Y]=>0.362;loopGapSwap[N]=>0.009;loopGapSwap[Y]=>7.259;stemExtend[N]=>1.816;stemExtend[Y]=>0.481;stemGapOpen[N]=>0.075;stemGapOpen[Y]=>4.294;stemGapExtend[N]=>1.414;stemGapExtend[Y]=>0.678;stemGapSwap[N]=>0.001;stemGapSwap[Y]=>9.644;multiExtend[N]=>1.063;multiExtend[Y]=>0.939;multiBulgeOpen[N]=>3.080;multiBulgeOpen[Y]=>0.181;stem_to_[loop]=>1.360;stem_to_[bulge]=>2.918;stem_to_[lrbulge]=>1.478;stem_to_[multiloop]=>3.064;emit[A]=>1.670;emit[C]=>2.412;emit[G]=>2.191;emit[U]=>1.840;pair[AA]=>5.166;pair[CA]=>5.768;pair[GA]=>5.411;pair[UA]=>2.670;pair[AC]=>6.065;pair[CC]=>6.305;pair[GC]=>2.281;pair[UC]=>5.821;pair[AG]=>5.578;pair[CG]=>2.691;pair[GG]=>5.464;pair[UG]=>4.105;pair[AU]=>2.756;pair[CU]=>5.835;pair[GU]=>4.091;pair[UU]=>4.582;subA[A]=>1.007;subA[C]=>2.888;subA[G]=>2.463;subA[U]=>2.424;subC[A]=>1.948;subC[C]=>1.768;subC[G]=>2.464;subC[U]=>1.909;subG[A]=>1.881;subG[C]=>2.822;subG[G]=>1.345;subG[U]=>2.368;subU[A]=>1.948;subU[C]=>2.372;subU[G]=>2.473;subU[U]=>1.442;subAA[AA]=>3.971;subAA[CA]=>4.790;subAA[GA]=>4.784;subAA[UA]=>2.755;subAA[AC]=>5.138;subAA[CC]=>4.949;subAA[GC]=>3.407;subAA[UC]=>5.233;subAA[AG]=>4.896;subAA[CG]=>3.194;subAA[GG]=>4.744;subAA[UG]=>3.707;subAA[AU]=>3.092;subAA[CU]=>4.918;subAA[GU]=>4.072;subAA[UU]=>3.883;subCA[AA]=>4.354;subCA[CA]=>5.001;subCA[GA]=>4.935;subCA[UA]=>3.027;subCA[AC]=>5.864;subCA[CC]=>5.031;subCA[GC]=>3.757;subCA[UC]=>4.579;subCA[AG]=>5.085;subCA[CG]=>2.663;subCA[GG]=>5.418;subCA[UG]=>3.829;subCA[AU]=>2.748;subCA[CU]=>4.386;subCA[GU]=>4.765;subCA[UU]=>3.528;subGA[AA]=>4.597;subGA[CA]=>5.190;subGA[GA]=>2.881;subGA[UA]=>3.057;subGA[AC]=>5.509;subGA[CC]=>5.307;subGA[GC]=>3.090;subGA[UC]=>4.992;subGA[AG]=>4.844;subGA[CG]=>3.058;subGA[GG]=>4.626;subGA[UG]=>4.284;subGA[AU]=>3.317;subGA[CU]=>5.486;subGA[GU]=>4.363;subGA[UU]=>4.021;subUA[AA]=>5.206;subUA[CA]=>5.905;subUA[GA]=>5.690;subUA[UA]=>2.314;subUA[AC]=>6.195;subUA[CC]=>6.312;subUA[GC]=>2.667;subUA[UC]=>6.165;subUA[AG]=>6.148;subUA[CG]=>2.432;subUA[GG]=>5.830;subUA[UG]=>4.018;subUA[AU]=>2.656;subUA[CU]=>6.100;subUA[GU]=>4.355;subUA[UU]=>4.733;subAC[AA]=>4.338;subAC[CA]=>5.513;subAC[GA]=>4.894;subAC[UA]=>2.952;subAC[AC]=>4.403;subAC[CC]=>4.873;subAC[GC]=>3.029;subAC[UC]=>5.013;subAC[AG]=>4.814;subAC[CG]=>3.236;subAC[GG]=>5.007;subAC[UG]=>3.810;subAC[AU]=>2.770;subAC[CU]=>5.396;subAC[GU]=>4.132;subAC[UU]=>4.066;subCC[AA]=>4.181;subCC[CA]=>4.693;subCC[GA]=>4.711;subCC[UA]=>3.114;subCC[AC]=>4.887;subCC[CC]=>4.439;subCC[GC]=>3.323;subCC[UC]=>4.145;subCC[AG]=>4.779;subCC[CG]=>3.156;subCC[GG]=>5.236;subCC[UG]=>3.929;subCC[AU]=>3.036;subCC[CU]=>4.589;subCC[GU]=>4.450;subCC[UU]=>3.913;subGC[AA]=>6.013;subGC[CA]=>6.801;subGC[GA]=>5.879;subGC[UA]=>2.817;subGC[AC]=>6.433;subGC[CC]=>6.684;subGC[GC]=>1.833;subGC[UC]=>6.376;subGC[AG]=>6.447;subGC[CG]=>2.803;subGC[GG]=>6.108;subGC[UG]=>4.561;subGC[AU]=>2.371;subGC[CU]=>6.928;subGC[GU]=>3.935;subGC[UU]=>5.352;subUC[AA]=>4.648;subUC[CA]=>4.434;subUC[GA]=>4.594;subUC[UA]=>3.134;subUC[AC]=>5.230;subUC[CC]=>4.328;subUC[GC]=>3.186;subUC[UC]=>4.283;subUC[AG]=>5.039;subUC[CG]=>2.944;subUC[GG]=>5.011;subUC[UG]=>3.594;subUC[AU]=>3.299;subUC[CU]=>5.389;subUC[GU]=>4.209;subUC[UU]=>3.892;subAG[AA]=>4.509;subAG[CA]=>5.142;subAG[GA]=>4.644;subAG[UA]=>3.311;subAG[AC]=>5.229;subAG[CC]=>5.177;subAG[GC]=>3.451;subAG[UC]=>5.238;subAG[AG]=>2.632;subAG[CG]=>3.202;subAG[GG]=>4.388;subAG[UG]=>3.876;subAG[AU]=>3.106;subAG[CU]=>5.409;subAG[GU]=>4.674;subAG[UU]=>4.309;subCG[AA]=>5.747;subCG[CA]=>5.644;subCG[GA]=>5.794;subCG[UA]=>2.537;subCG[AC]=>6.581;subCG[CC]=>6.455;subCG[GC]=>2.759;subCG[UC]=>6.076;subCG[AG]=>6.141;subCG[CG]=>1.863;subCG[GG]=>5.623;subCG[UG]=>4.057;subCG[AU]=>2.964;subCG[CU]=>6.186;subCG[GU]=>4.480;subCG[UU]=>5.014;subGG[AA]=>4.389;subGG[CA]=>5.521;subGG[GA]=>4.458;subGG[UA]=>3.022;subGG[AC]=>5.465;subGG[CC]=>5.696;subGG[GC]=>3.145;subGG[UC]=>5.249;subGG[AG]=>4.420;subGG[CG]=>2.713;subGG[GG]=>4.060;subGG[UG]=>4.034;subGG[AU]=>3.467;subGG[CU]=>5.228;subGG[GU]=>3.967;subGG[UU]=>3.651;subUG[AA]=>4.769;subUG[CA]=>5.322;subUG[GA]=>5.533;subUG[UA]=>2.629;subUG[AC]=>5.669;subUG[CC]=>5.753;subUG[GC]=>3.022;subUG[UC]=>5.236;subUG[AG]=>5.323;subUG[CG]=>2.564;subUG[GG]=>5.452;subUG[UG]=>3.334;subUG[AU]=>2.898;subUG[CU]=>5.490;subUG[GU]=>4.571;subUG[UU]=>4.234;subAU[AA]=>5.538;subAU[CA]=>5.619;subAU[GA]=>5.946;subAU[UA]=>2.652;subAU[AC]=>6.007;subAU[CC]=>6.227;subAU[GC]=>2.219;subAU[UC]=>6.323;subAU[AG]=>5.937;subAU[CG]=>2.854;subAU[GG]=>6.269;subAU[UG]=>4.282;subAU[AU]=>2.218;subAU[CU]=>6.559;subAU[GU]=>4.337;subAU[UU]=>4.922;subCU[AA]=>4.152;subCU[CA]=>4.056;subCU[GA]=>4.917;subCU[UA]=>2.878;subCU[AC]=>5.454;subCU[CC]=>4.605;subCU[GC]=>3.546;subCU[UC]=>5.222;subCU[AG]=>5.039;subCU[CG]=>2.861;subCU[GG]=>4.818;subCU[UG]=>3.659;subCU[AU]=>3.345;subCU[CU]=>4.891;subCU[GU]=>4.659;subCU[UU]=>3.571;subGU[AA]=>5.027;subGU[CA]=>6.169;subGU[GA]=>5.506;subGU[UA]=>2.855;subGU[AC]=>5.891;subGU[CC]=>6.187;subGU[GC]=>2.285;subGU[UC]=>5.753;subGU[AG]=>6.024;subGU[CG]=>2.875;subGU[GG]=>5.278;subGU[UG]=>4.463;subGU[AU]=>2.841;subGU[CU]=>6.385;subGU[GU]=>2.924;subGU[UU]=>4.830;subUU[AA]=>4.455;subUU[CA]=>4.530;subUU[GA]=>4.779;subUU[UA]=>2.856;subUU[AC]=>5.438;subUU[CC]=>5.247;subUU[GC]=>3.322;subUU[UC]=>5.047;subUU[AG]=>5.269;subUU[CG]=>3.032;subUU[GG]=>4.580;subUU[UG]=>3.744;subUU[AU]=>3.049;subUU[CU]=>4.913;subUU[GU]=>4.448;subUU[UU]=>3.429;nullEmit2[A]=>1.945;nullEmit2[C]=>2.134;nullEmit2[G]=>1.864;nullEmit2[U]=>2.070;nullExtend2[N]=>15.180;nullExtend2[Y]=>0.000;startInStem2[N]=>0.073;startInStem2[Y]=>4.335;loopExtend2[N]=>2.227;loopExtend2[Y]=>0.346;loopGapOpen2[N]=>0.134;loopGapOpen2[Y]=>3.493;loopGapExtend2[N]=>1.868;loopGapExtend2[Y]=>0.461;loopGapSwap2[N]=>0.007;loopGapSwap2[Y]=>7.656;stemExtend2[N]=>1.959;stemExtend2[Y]=>0.428;stemGapOpen2[N]=>0.038;stemGapOpen2[Y]=>5.243;stemGapExtend2[N]=>1.381;stemGapExtend2[Y]=>0.698;stemGapSwap2[N]=>0.010;stemGapSwap2[Y]=>7.067;multiExtend2[N]=>0.764;multiExtend2[Y]=>1.282;multiBulgeOpen2[N]=>2.654;multiBulgeOpen2[Y]=>0.249;stem_to_2[loop]=>1.361;stem_to_2[bulge]=>2.694;stem_to_2[lrbulge]=>1.661;stem_to_2[multiloop]=>2.833;emit2[A]=>1.707;emit2[C]=>2.313;emit2[G]=>2.058;emit2[U]=>1.986;pair2[AA]=>5.929;pair2[CA]=>6.733;pair2[GA]=>5.956;pair2[UA]=>2.693;pair2[AC]=>6.291;pair2[CC]=>7.372;pair2[GC]=>1.986;pair2[UC]=>6.712;pair2[AG]=>6.304;pair2[CG]=>2.143;pair2[GG]=>6.093;pair2[UG]=>4.174;pair2[AU]=>2.852;pair2[CU]=>7.057;pair2[GU]=>4.256;pair2[UU]=>6.016;subA2[A]=>0.625;subA2[C]=>3.473;subA2[G]=>2.941;subA2[U]=>2.926;subC2[A]=>2.528;subC2[C]=>1.054;subC2[G]=>2.960;subC2[U]=>2.205;subG2[A]=>2.302;subG2[C]=>3.268;subG2[G]=>0.866;subG2[U]=>2.787;subU2[A]=>2.391;subU2[C]=>2.617;subU2[G]=>2.891;subU2[U]=>0.966;subAA2[AA]=>2.809;subAA2[CA]=>5.140;subAA2[GA]=>4.576;subAA2[UA]=>2.862;subAA2[AC]=>4.651;subAA2[CC]=>5.615;subAA2[GC]=>3.341;subAA2[UC]=>5.399;subAA2[AG]=>4.152;subAA2[CG]=>3.166;subAA2[GG]=>5.137;subAA2[UG]=>4.380;subAA2[AU]=>3.140;subAA2[CU]=>5.310;subAA2[GU]=>4.280;subAA2[UU]=>4.923;subCA2[AA]=>4.637;subCA2[CA]=>3.816;subCA2[GA]=>4.798;subCA2[UA]=>2.664;subCA2[AC]=>5.162;subCA2[CC]=>4.840;subCA2[GC]=>3.294;subCA2[UC]=>5.380;subCA2[AG]=>4.696;subCA2[CG]=>2.815;subCA2[GG]=>4.541;subCA2[UG]=>3.713;subCA2[AU]=>3.632;subCA2[CU]=>4.879;subCA2[GU]=>4.625;subCA2[UU]=>4.281;subGA2[AA]=>4.609;subGA2[CA]=>5.340;subGA2[GA]=>2.519;subGA2[UA]=>3.233;subGA2[AC]=>5.486;subGA2[CC]=>5.469;subGA2[GC]=>3.358;subGA2[UC]=>3.834;subGA2[AG]=>4.956;subGA2[CG]=>3.360;subGA2[GG]=>3.970;subGA2[UG]=>4.586;subGA2[AU]=>4.006;subGA2[CU]=>5.201;subGA2[GU]=>3.470;subGA2[UU]=>5.230;subUA2[AA]=>5.741;subUA2[CA]=>5.910;subUA2[GA]=>6.076;subUA2[UA]=>1.252;subUA2[AC]=>6.944;subUA2[CC]=>7.407;subUA2[GC]=>3.176;subUA2[UC]=>5.877;subUA2[AG]=>6.620;subUA2[CG]=>2.447;subUA2[GG]=>7.115;subUA2[UG]=>4.315;subUA2[AU]=>3.526;subUA2[CU]=>6.914;subUA2[GU]=>5.301;subUA2[UU]=>5.871;subAC2[AA]=>4.416;subAC2[CA]=>5.454;subAC2[GA]=>5.203;subAC2[UA]=>3.806;subAC2[AC]=>3.042;subAC2[CC]=>4.439;subAC2[GC]=>2.850;subAC2[UC]=>3.802;subAC2[AG]=>4.939;subAC2[CG]=>3.654;subAC2[GG]=>5.084;subAC2[UG]=>4.398;subAC2[AU]=>2.958;subAC2[CU]=>4.839;subAC2[GU]=>3.753;subAC2[UU]=>5.196;subCC2[AA]=>4.656;subCC2[CA]=>4.462;subCC2[GA]=>4.528;subCC2[UA]=>3.724;subCC2[AC]=>3.900;subCC2[CC]=>4.084;subCC2[GC]=>3.308;subCC2[UC]=>3.936;subCC2[AG]=>3.937;subCC2[CG]=>2.968;subCC2[GG]=>4.461;subCC2[UG]=>4.114;subCC2[AU]=>4.017;subCC2[CU]=>4.425;subCC2[GU]=>4.174;subCC2[UU]=>4.504;subGC2[AA]=>6.937;subGC2[CA]=>7.293;subGC2[GA]=>6.909;subGC2[UA]=>3.879;subGC2[AC]=>6.638;subGC2[CC]=>7.602;subGC2[GC]=>0.766;subGC2[UC]=>7.017;subGC2[AG]=>7.072;subGC2[CG]=>3.521;subGC2[GG]=>6.788;subGC2[UG]=>5.133;subGC2[AU]=>3.265;subGC2[CU]=>7.780;subGC2[GU]=>4.301;subGC2[UU]=>7.096;subUC2[AA]=>4.978;subUC2[CA]=>5.470;subUC2[GA]=>3.549;subUC2[UA]=>2.798;subUC2[AC]=>3.758;subUC2[CC]=>4.387;subUC2[GC]=>3.201;subUC2[UC]=>3.901;subUC2[AG]=>5.177;subUC2[CG]=>3.805;subUC2[GG]=>5.104;subUC2[UG]=>4.033;subUC2[AU]=>3.485;subUC2[CU]=>4.627;subUC2[GU]=>4.273;subUC2[UU]=>4.366;subAG2[AA]=>3.941;subAG2[CA]=>4.957;subAG2[GA]=>4.692;subAG2[UA]=>3.514;subAG2[AC]=>4.944;subAG2[CC]=>4.490;subAG2[GC]=>3.278;subAG2[UC]=>5.363;subAG2[AG]=>3.051;subAG2[CG]=>2.931;subAG2[GG]=>4.166;subAG2[UG]=>4.219;subAG2[AU]=>3.402;subAG2[CU]=>4.849;subAG2[GU]=>4.234;subAG2[UU]=>5.120;subCG2[AA]=>6.586;subCG2[CA]=>6.604;subCG2[GA]=>6.740;subCG2[UA]=>2.978;subCG2[AC]=>7.314;subCG2[CC]=>7.032;subCG2[GC]=>3.348;subCG2[UC]=>7.527;subCG2[AG]=>6.538;subCG2[CG]=>0.926;subCG2[GG]=>6.374;subCG2[UG]=>4.108;subCG2[AU]=>3.773;subCG2[CU]=>6.793;subCG2[GU]=>5.283;subCG2[UU]=>6.521;subGG2[AA]=>5.056;subGG2[CA]=>4.956;subGG2[GA]=>3.876;subGG2[UA]=>4.129;subGG2[AC]=>5.257;subGG2[CC]=>5.279;subGG2[GC]=>3.154;subGG2[UC]=>5.453;subGG2[AG]=>4.322;subGG2[CG]=>2.918;subGG2[GG]=>2.303;subGG2[UG]=>4.413;subGG2[AU]=>4.143;subGG2[CU]=>5.251;subGG2[GU]=>3.797;subGG2[UU]=>4.679;subUG2[AA]=>5.933;subUG2[CA]=>5.674;subUG2[GA]=>6.114;subUG2[UA]=>2.954;subUG2[AC]=>6.196;subUG2[CC]=>6.513;subUG2[GC]=>3.069;subUG2[UC]=>5.872;subUG2[AG]=>5.993;subUG2[CG]=>2.217;subUG2[GG]=>6.033;subUG2[UG]=>1.846;subUG2[AU]=>3.780;subUG2[CU]=>5.978;subUG2[GU]=>5.183;subUG2[UU]=>5.674;subAU2[AA]=>5.836;subAU2[CA]=>6.776;subAU2[GA]=>6.695;subAU2[UA]=>3.332;subAU2[AC]=>5.857;subAU2[CC]=>7.601;subAU2[GC]=>2.368;subAU2[UC]=>6.440;subAU2[AG]=>6.310;subAU2[CG]=>3.048;subAU2[GG]=>6.943;subAU2[UG]=>4.954;subAU2[AU]=>1.434;subAU2[CU]=>5.990;subAU2[GU]=>4.146;subAU2[UU]=>5.582;subCU2[AA]=>4.655;subCU2[CA]=>4.738;subCU2[GA]=>4.545;subCU2[UA]=>3.527;subCU2[AC]=>4.472;subCU2[CC]=>4.664;subCU2[GC]=>3.664;subCU2[UC]=>4.390;subCU2[AG]=>4.475;subCU2[CG]=>2.953;subCU2[GG]=>4.677;subCU2[UG]=>3.905;subCU2[AU]=>2.882;subCU2[CU]=>4.222;subCU2[GU]=>4.069;subCU2[UU]=>4.218;subGU2[AA]=>5.704;subGU2[CA]=>6.601;subGU2[GA]=>4.818;subGU2[UA]=>3.802;subGU2[AC]=>5.381;subGU2[CC]=>6.474;subGU2[GC]=>2.102;subGU2[UC]=>6.029;subGU2[AG]=>5.886;subGU2[CG]=>3.253;subGU2[GG]=>5.255;subGU2[UG]=>5.054;subGU2[AU]=>2.841;subGU2[CU]=>6.054;subGU2[GU]=>2.197;subGU2[UU]=>5.090;subUU2[AA]=>4.839;subUU2[CA]=>4.663;subUU2[GA]=>5.125;subUU2[UA]=>2.905;subUU2[AC]=>5.377;subUU2[CC]=>5.337;subUU2[GC]=>3.412;subUU2[UC]=>4.611;subUU2[AG]=>5.294;subUU2[CG]=>3.021;subUU2[GG]=>4.666;subUU2[UG]=>4.048;subUU2[AU]=>2.810;subUU2[CU]=>4.704;subUU2[GU]=>3.608;subUU2[UU]=>3.866;nullEmit3[A]=>1.978;nullEmit3[C]=>2.097;nullEmit3[G]=>1.858;nullEmit3[U]=>2.077;nullExtend3[N]=>8.475;nullExtend3[Y]=>0.004;startInStem3[N]=>0.245;startInStem3[Y]=>2.674;loopExtend3[N]=>2.418;loopExtend3[Y]=>0.298;loopGapOpen3[N]=>0.076;loopGapOpen3[Y]=>4.270;loopGapExtend3[N]=>1.654;loopGapExtend3[Y]=>0.551;loopGapSwap3[N]=>0.007;loopGapSwap3[Y]=>7.500;stemExtend3[N]=>1.988;stemExtend3[Y]=>0.418;stemGapOpen3[N]=>0.014;stemGapOpen3[Y]=>6.676;stemGapExtend3[N]=>1.446;stemGapExtend3[Y]=>0.659;stemGapSwap3[N]=>0.061;stemGapSwap3[Y]=>4.587;multiExtend3[N]=>1.046;multiExtend3[Y]=>0.954;multiBulgeOpen3[N]=>2.581;multiBulgeOpen3[Y]=>0.263;stem_to_3[loop]=>1.422;stem_to_3[bulge]=>2.128;stem_to_3[lrbulge]=>1.836;stem_to_3[multiloop]=>3.079;emit3[A]=>1.693;emit3[C]=>2.330;emit3[G]=>2.101;emit3[U]=>1.948;pair3[AA]=>6.435;pair3[CA]=>6.668;pair3[GA]=>6.170;pair3[UA]=>2.724;pair3[AC]=>6.824;pair3[CC]=>7.238;pair3[GC]=>1.934;pair3[UC]=>7.545;pair3[AG]=>6.529;pair3[CG]=>1.946;pair3[GG]=>6.308;pair3[UG]=>4.228;pair3[AU]=>2.915;pair3[CU]=>7.457;pair3[GU]=>4.528;pair3[UU]=>6.240;subA3[A]=>0.328;subA3[C]=>4.376;subA3[G]=>3.586;subA3[U]=>3.793;subC3[A]=>3.461;subC3[C]=>0.601;subC3[G]=>3.765;subC3[U]=>2.499;subG3[A]=>2.961;subG3[C]=>4.054;subG3[G]=>0.435;subG3[U]=>3.795;subU3[A]=>3.354;subU3[C]=>2.977;subU3[G]=>3.981;subU3[U]=>0.490;subAA3[AA]=>1.558;subAA3[CA]=>4.354;subAA3[GA]=>4.453;subAA3[UA]=>3.842;subAA3[AC]=>4.259;subAA3[CC]=>5.048;subAA3[GC]=>4.826;subAA3[UC]=>5.115;subAA3[AG]=>4.047;subAA3[CG]=>4.510;subAA3[GG]=>4.491;subAA3[UG]=>5.008;subAA3[AU]=>3.891;subAA3[CU]=>5.054;subAA3[GU]=>4.726;subAA3[UU]=>4.856;subCA3[AA]=>4.246;subCA3[CA]=>1.695;subCA3[GA]=>4.361;subCA3[UA]=>3.636;subCA3[AC]=>4.917;subCA3[CC]=>4.453;subCA3[GC]=>4.511;subCA3[UC]=>4.776;subCA3[AG]=>4.935;subCA3[CG]=>3.565;subCA3[GG]=>4.980;subCA3[UG]=>4.094;subCA3[AU]=>4.721;subCA3[CU]=>4.639;subCA3[GU]=>4.980;subCA3[UU]=>4.902;subGA3[AA]=>4.547;subGA3[CA]=>4.571;subGA3[GA]=>1.318;subGA3[UA]=>4.253;subGA3[AC]=>4.747;subGA3[CC]=>5.287;subGA3[GC]=>3.955;subGA3[UC]=>5.285;subGA3[AG]=>4.987;subGA3[CG]=>4.649;subGA3[GG]=>3.910;subGA3[UG]=>5.201;subGA3[AU]=>4.686;subGA3[CU]=>4.874;subGA3[GU]=>4.483;subGA3[UU]=>5.253;subUA3[AA]=>5.851;subUA3[CA]=>5.644;subUA3[GA]=>6.438;subUA3[UA]=>0.644;subUA3[AC]=>7.303;subUA3[CC]=>7.557;subUA3[GC]=>4.713;subUA3[UC]=>5.855;subUA3[AG]=>6.816;subUA3[CG]=>3.220;subUA3[GG]=>6.960;subUA3[UG]=>4.534;subUA3[AU]=>4.828;subUA3[CU]=>7.007;subUA3[GU]=>5.925;subUA3[UU]=>5.814;subAC3[AA]=>4.075;subAC3[CA]=>4.816;subAC3[GA]=>4.424;subAC3[UA]=>4.444;subAC3[AC]=>2.266;subAC3[CC]=>4.273;subAC3[GC]=>3.492;subAC3[UC]=>4.550;subAC3[AG]=>4.536;subAC3[CG]=>4.249;subAC3[GG]=>4.670;subAC3[UG]=>4.890;subAC3[AU]=>3.487;subAC3[CU]=>4.551;subAC3[GU]=>3.980;subAC3[UU]=>4.110;subCC3[AA]=>4.650;subCC3[CA]=>4.302;subCC3[GA]=>4.716;subCC3[UA]=>4.466;subCC3[AC]=>4.230;subCC3[CC]=>1.840;subCC3[GC]=>4.257;subCC3[UC]=>3.679;subCC3[AG]=>4.677;subCC3[CG]=>4.305;subCC3[GG]=>4.692;subCC3[UG]=>4.391;subCC3[AU]=>4.245;subCC3[CU]=>4.402;subCC3[GU]=>4.552;subCC3[UU]=>4.483;subGC3[AA]=>8.346;subGC3[CA]=>7.982;subGC3[GA]=>6.655;subGC3[UA]=>5.384;subGC3[AC]=>6.191;subGC3[CC]=>7.731;subGC3[GC]=>0.445;subGC3[UC]=>6.551;subGC3[AG]=>7.991;subGC3[CG]=>4.130;subGC3[GG]=>6.687;subGC3[UG]=>6.706;subGC3[AU]=>3.966;subGC3[CU]=>8.082;subGC3[GU]=>4.565;subGC3[UU]=>7.490;subUC3[AA]=>4.575;subUC3[CA]=>4.431;subUC3[GA]=>4.589;subUC3[UA]=>3.710;subUC3[AC]=>4.334;subUC3[CC]=>3.589;subUC3[GC]=>3.717;subUC3[UC]=>2.737;subUC3[AG]=>4.564;subUC3[CG]=>3.946;subUC3[GG]=>4.499;subUC3[UG]=>4.023;subUC3[AU]=>4.050;subUC3[CU]=>4.239;subUC3[GU]=>4.279;subUC3[UU]=>4.119;subAG3[AA]=>3.939;subAG3[CA]=>4.984;subAG3[GA]=>4.761;subAG3[UA]=>4.291;subAG3[AC]=>4.660;subAG3[CC]=>4.989;subAG3[GC]=>4.538;subAG3[UC]=>5.005;subAG3[AG]=>1.861;subAG3[CG]=>3.547;subAG3[GG]=>3.659;subAG3[UG]=>3.834;subAG3[AU]=>4.149;subAG3[CU]=>4.860;subAG3[GU]=>4.664;subAG3[UU]=>5.063;subCG3[AA]=>7.737;subCG3[CA]=>6.194;subCG3[GA]=>7.808;subCG3[UA]=>3.871;subCG3[AC]=>7.615;subCG3[CC]=>7.851;subCG3[GC]=>4.120;subCG3[UC]=>7.143;subCG3[AG]=>6.229;subCG3[CG]=>0.509;subCG3[GG]=>6.523;subCG3[UG]=>4.531;subCG3[AU]=>4.788;subCG3[CU]=>6.457;subCG3[GU]=>6.477;subCG3[UU]=>7.318;subGG3[AA]=>4.530;subGG3[CA]=>5.197;subGG3[GA]=>3.871;subGG3[UA]=>4.510;subGG3[AC]=>4.965;subGG3[CC]=>5.175;subGG3[GC]=>3.934;subGG3[UC]=>5.075;subGG3[AG]=>3.768;subGG3[CG]=>3.839;subGG3[GG]=>1.728;subGG3[UG]=>4.030;subGG3[AU]=>4.641;subGG3[CU]=>5.214;subGG3[GU]=>4.020;subGG3[UU]=>5.173;subUG3[AA]=>6.559;subUG3[CA]=>5.237;subUG3[GA]=>6.631;subUG3[UA]=>3.425;subUG3[AC]=>6.759;subUG3[CC]=>6.057;subUG3[GC]=>4.827;subUG3[UC]=>5.433;subUG3[AG]=>4.840;subUG3[CG]=>2.787;subUG3[GG]=>4.959;subUG3[UG]=>1.080;subUG3[AU]=>5.289;subUG3[CU]=>6.331;subUG3[GU]=>5.420;subUG3[UU]=>5.014;subAU3[AA]=>5.785;subAU3[CA]=>7.486;subAU3[GA]=>6.999;subAU3[UA]=>4.687;subAU3[AC]=>5.363;subAU3[CC]=>6.822;subAU3[GC]=>3.170;subAU3[UC]=>6.584;subAU3[AG]=>6.408;subAU3[CG]=>3.996;subAU3[GG]=>7.026;subAU3[UG]=>6.363;subAU3[AU]=>0.805;subAU3[CU]=>5.281;subAU3[GU]=>4.009;subAU3[UU]=>5.575;subCU3[AA]=>4.564;subCU3[CA]=>4.355;subCU3[GA]=>4.345;subCU3[UA]=>4.165;subCU3[AC]=>4.360;subCU3[CC]=>4.315;subCU3[GC]=>4.297;subCU3[UC]=>4.261;subCU3[AG]=>4.492;subCU3[CG]=>3.682;subCU3[GG]=>4.628;subCU3[UG]=>4.424;subCU3[AU]=>3.515;subCU3[CU]=>2.546;subCU3[GU]=>4.301;subCU3[UU]=>3.582;subGU3[AA]=>5.864;subGU3[CA]=>6.475;subGU3[GA]=>5.335;subGU3[UA]=>4.534;subGU3[AC]=>4.956;subGU3[CC]=>6.161;subGU3[GC]=>2.625;subGU3[UC]=>5.811;subGU3[AG]=>5.922;subGU3[CG]=>4.420;subGU3[GG]=>4.730;subGU3[UG]=>5.193;subGU3[AU]=>2.862;subGU3[CU]=>5.809;subGU3[GU]=>1.520;subGU3[UU]=>4.452;subUU3[AA]=>4.929;subUU3[CA]=>5.131;subUU3[GA]=>5.196;subUU3[UA]=>3.788;subUU3[AC]=>4.316;subUU3[CC]=>4.893;subUU3[GC]=>4.399;subUU3[UC]=>4.496;subUU3[AG]=>5.254;subUU3[CG]=>4.304;subUU3[GG]=>5.194;subUU3[UG]=>4.048;subUU3[AU]=>3.725;subUU3[CU]=>3.654;subUU3[GU]=>3.797;subUU3[UU]=>1.878;nullEmit4[A]=>1.940;nullEmit4[C]=>2.184;nullEmit4[G]=>1.745;nullEmit4[U]=>2.175;nullExtend4[N]=>8.224;nullExtend4[Y]=>0.004;startInStem4[N]=>0.186;startInStem4[Y]=>3.042;loopExtend4[N]=>2.370;loopExtend4[Y]=>0.310;loopGapOpen4[N]=>0.021;loopGapOpen4[Y]=>6.097;loopGapExtend4[N]=>1.189;loopGapExtend4[Y]=>0.832;loopGapSwap4[N]=>0.018;loopGapSwap4[Y]=>6.316;stemExtend4[N]=>2.303;stemExtend4[Y]=>0.326;stemGapOpen4[N]=>0.001;stemGapOpen4[Y]=>10.370;stemGapExtend4[N]=>1.249;stemGapExtend4[Y]=>0.787;stemGapSwap4[N]=>0.266;stemGapSwap4[Y]=>2.566;multiExtend4[N]=>0.918;multiExtend4[Y]=>1.086;multiBulgeOpen4[N]=>2.495;multiBulgeOpen4[Y]=>0.281;stem_to_4[loop]=>1.285;stem_to_4[bulge]=>2.605;stem_to_4[lrbulge]=>1.751;stem_to_4[multiloop]=>2.963;emit4[A]=>1.533;emit4[C]=>2.610;emit4[G]=>1.902;emit4[U]=>2.162;pair4[AA]=>7.573;pair4[CA]=>7.690;pair4[GA]=>8.434;pair4[UA]=>2.721;pair4[AC]=>7.522;pair4[CC]=>9.569;pair4[GC]=>1.860;pair4[UC]=>9.093;pair4[AG]=>6.862;pair4[CG]=>1.972;pair4[GG]=>7.434;pair4[UG]=>4.536;pair4[AU]=>2.511;pair4[CU]=>9.070;pair4[GU]=>4.095;pair4[UU]=>8.163;subA4[A]=>0.098;subA4[C]=>6.787;subA4[G]=>4.848;subA4[U]=>5.505;subC4[A]=>5.725;subC4[C]=>0.111;subC4[G]=>6.423;subC4[U]=>4.519;subG4[A]=>4.499;subG4[C]=>7.135;subG4[G]=>0.087;subG4[U]=>7.098;subU4[A]=>4.878;subU4[C]=>4.954;subU4[G]=>6.822;subU4[U]=>0.112;subAA4[AA]=>0.840;subAA4[CA]=>5.422;subAA4[GA]=>5.324;subAA4[UA]=>4.369;subAA4[AC]=>4.909;subAA4[CC]=>5.446;subAA4[GC]=>5.263;subAA4[UC]=>5.446;subAA4[AG]=>4.663;subAA4[CG]=>5.446;subAA4[GG]=>5.446;subAA4[UG]=>5.446;subAA4[AU]=>3.994;subAA4[CU]=>5.446;subAA4[GU]=>5.446;subAA4[UU]=>5.446;subCA4[AA]=>5.346;subCA4[CA]=>1.899;subCA4[GA]=>4.613;subCA4[UA]=>3.537;subCA4[AC]=>5.370;subCA4[CC]=>5.053;subCA4[GC]=>5.370;subCA4[UC]=>5.370;subCA4[AG]=>5.370;subCA4[CG]=>1.725;subCA4[GG]=>5.370;subCA4[UG]=>5.256;subCA4[AU]=>5.370;subCA4[CU]=>5.140;subCA4[GU]=>5.370;subCA4[UU]=>5.370;subGA4[AA]=>4.842;subGA4[CA]=>4.303;subGA4[GA]=>1.445;subGA4[UA]=>4.113;subGA4[AC]=>4.941;subGA4[CC]=>4.941;subGA4[GC]=>3.330;subGA4[UC]=>4.941;subGA4[AG]=>4.941;subGA4[CG]=>4.941;subGA4[GG]=>4.678;subGA4[UG]=>4.941;subGA4[AU]=>4.941;subGA4[CU]=>4.941;subGA4[GU]=>4.100;subGA4[UU]=>4.941;subUA4[AA]=>8.307;subUA4[CA]=>7.451;subUA4[GA]=>8.436;subUA4[UA]=>0.093;subUA4[AC]=>9.712;subUA4[CC]=>9.712;subUA4[GC]=>9.468;subUA4[UC]=>8.546;subUA4[AG]=>9.686;subUA4[CG]=>7.790;subUA4[GG]=>9.712;subUA4[UG]=>5.084;subUA4[AU]=>9.250;subUA4[CU]=>9.712;subUA4[GU]=>9.712;subUA4[UU]=>7.850;subAC4[AA]=>4.933;subAC4[CA]=>5.479;subAC4[GA]=>5.479;subAC4[UA]=>5.479;subAC4[AC]=>1.188;subAC4[CC]=>5.004;subAC4[GC]=>3.058;subAC4[UC]=>5.245;subAC4[AG]=>4.740;subAC4[CG]=>5.453;subAC4[GG]=>5.479;subAC4[UG]=>5.479;subAC4[AU]=>3.181;subAC4[CU]=>5.479;subAC4[GU]=>5.390;subAC4[UU]=>5.479;subCC4[AA]=>4.470;subCC4[CA]=>4.272;subCC4[GA]=>4.470;subCC4[UA]=>4.470;subCC4[AC]=>4.172;subCC4[CC]=>3.000;subCC4[GC]=>2.825;subCC4[UC]=>4.188;subCC4[AG]=>4.470;subCC4[CG]=>3.257;subCC4[GG]=>4.470;subCC4[UG]=>4.470;subCC4[AU]=>4.470;subCC4[CU]=>4.075;subCC4[GU]=>4.406;subCC4[UU]=>4.470;subGC4[AA]=>10.295;subGC4[CA]=>10.561;subGC4[GA]=>8.297;subGC4[UA]=>10.314;subGC4[AC]=>7.677;subGC4[CC]=>7.906;subGC4[GC]=>0.055;subGC4[UC]=>8.728;subGC4[AG]=>10.561;subGC4[CG]=>10.408;subGC4[GG]=>9.512;subGC4[UG]=>10.367;subGC4[AU]=>7.563;subGC4[CU]=>10.503;subGC4[GU]=>6.567;subGC4[UU]=>10.472;subUC4[AA]=>4.642;subUC4[CA]=>4.642;subUC4[GA]=>4.642;subUC4[UA]=>4.016;subUC4[AC]=>4.489;subUC4[CC]=>4.340;subUC4[GC]=>3.565;subUC4[UC]=>1.721;subUC4[AG]=>4.642;subUC4[CG]=>4.598;subUC4[GG]=>4.642;subUC4[UG]=>4.297;subUC4[AU]=>4.539;subUC4[CU]=>4.642;subUC4[GU]=>4.642;subUC4[UU]=>4.605;subAG4[AA]=>5.060;subAG4[CA]=>5.936;subAG4[GA]=>5.936;subAG4[UA]=>5.914;subAG4[AC]=>5.121;subAG4[CC]=>5.936;subAG4[GC]=>5.936;subAG4[UC]=>5.936;subAG4[AG]=>0.769;subAG4[CG]=>3.220;subAG4[GG]=>5.158;subAG4[UG]=>4.459;subAG4[AU]=>5.226;subAG4[CU]=>5.936;subAG4[GU]=>5.936;subAG4[UU]=>5.936;subCG4[AA]=>10.450;subCG4[CA]=>6.267;subCG4[GA]=>10.450;subCG4[UA]=>8.520;subCG4[AC]=>10.413;subCG4[CC]=>8.351;subCG4[GC]=>10.298;subCG4[UC]=>10.353;subCG4[AG]=>7.417;subCG4[CG]=>0.070;subCG4[GG]=>8.601;subCG4[UG]=>6.388;subCG4[AU]=>10.370;subCG4[CU]=>9.048;subCG4[GU]=>10.438;subCG4[UU]=>9.663;subGG4[AA]=>5.538;subGG4[CA]=>5.538;subGG4[GA]=>5.211;subGG4[UA]=>5.538;subGG4[AC]=>5.538;subGG4[CC]=>5.538;subGG4[GC]=>4.743;subGG4[UC]=>5.538;subGG4[AG]=>4.828;subGG4[CG]=>4.055;subGG4[GG]=>0.808;subGG4[UG]=>4.204;subGG4[AU]=>5.538;subGG4[CU]=>5.538;subGG4[GU]=>5.538;subGG4[UU]=>5.538;subUG4[AA]=>7.962;subUG4[CA]=>7.803;subUG4[GA]=>7.962;subUG4[UA]=>3.396;subUG4[AC]=>7.962;subUG4[CC]=>7.962;subUG4[GC]=>7.777;subUG4[UC]=>7.292;subUG4[AG]=>6.290;subUG4[CG]=>3.970;subUG4[GG]=>6.332;subUG4[UG]=>0.385;subUG4[AU]=>7.962;subUG4[CU]=>7.918;subUG4[GU]=>7.962;subUG4[UU]=>7.123;subAU4[AA]=>8.080;subAU4[CA]=>9.921;subAU4[GA]=>9.921;subAU4[UA]=>9.459;subAU4[AC]=>7.178;subAU4[CC]=>9.921;subAU4[GC]=>6.933;subAU4[UC]=>9.695;subAU4[AG]=>9.062;subAU4[CG]=>9.841;subAU4[GG]=>9.921;subAU4[UG]=>9.921;subAU4[AU]=>0.090;subAU4[CU]=>8.307;subAU4[GU]=>5.593;subAU4[UU]=>7.136;subCU4[AA]=>4.636;subCU4[CA]=>4.481;subCU4[GA]=>4.636;subCU4[UA]=>4.636;subCU4[AC]=>4.636;subCU4[CC]=>4.208;subCU4[GC]=>4.610;subCU4[UC]=>4.636;subCU4[AG]=>4.636;subCU4[CG]=>3.851;subCU4[GG]=>4.636;subCU4[UG]=>4.616;subCU4[AU]=>3.700;subCU4[CU]=>1.834;subCU4[GU]=>4.488;subCU4[UU]=>3.905;subGU4[AA]=>8.380;subGU4[CA]=>8.380;subGU4[GA]=>7.110;subGU4[UA]=>8.380;subGU4[AC]=>8.256;subGU4[CC]=>8.232;subGU4[GC]=>4.437;subGU4[UC]=>8.380;subGU4[AG]=>8.380;subGU4[CG]=>8.369;subGU4[GG]=>8.380;subGU4[UG]=>8.380;subGU4[AU]=>4.092;subGU4[CU]=>8.074;subGU4[GU]=>0.239;subGU4[UU]=>7.249;subUU4[AA]=>5.085;subUU4[CA]=>5.085;subUU4[GA]=>5.085;subUU4[UA]=>3.724;subUU4[AC]=>5.085;subUU4[CC]=>5.085;subUU4[GC]=>5.033;subUU4[UC]=>5.035;subUU4[AG]=>5.085;subUU4[CG]=>4.570;subUU4[GG]=>5.085;subUU4[UG]=>4.510;subUU4[AU]=>2.913;subUU4[CU]=>4.169;subUU4[GU]=>4.295;subUU4[UU]=>1.590;", true, true);
}

void Stemloc_defaults::init_superstem_params (Telegraph_PScores_adaptor& fold_tgio)
{
  fold_tgio.read_from_string ("nullEmit[A]=>1.951;nullEmit[C]=>2.130;nullEmit[G]=>1.861;nullEmit[U]=>2.072;nullExtend[N]=>15.145;nullExtend[Y]=>0.000;startInStem[N]=>0.081;startInStem[Y]=>4.183;loopExtend[N]=>3.187;loopExtend[Y]=>0.167;bulgeExtend[N]=>2.262;bulgeExtend[Y]=>0.337;stemExtend[N]=>2.080;stemExtend[Y]=>0.389;multiExtend[N]=>0.746;multiExtend[Y]=>1.307;multiBulgeOpen[N]=>2.546;multiBulgeOpen[Y]=>0.270;stem_to_[loop]=>1.466;stem_to_[bulge]=>2.609;stem_to_[lrbulge]=>1.639;stem_to_[multiloop]=>2.706;emit[A]=>1.656;emit[C]=>2.346;emit[G]=>2.081;emit[U]=>2.001;open[AA]=>5.344;open[CA]=>6.999;open[GA]=>5.566;open[UA]=>2.825;open[AC]=>5.853;open[CC]=>6.952;open[GC]=>2.049;open[UC]=>5.979;open[AG]=>6.114;open[CG]=>2.160;open[GG]=>5.761;open[UG]=>4.416;open[AU]=>2.892;open[CU]=>6.761;open[GU]=>4.032;open[UU]=>6.148;stackAA[AA]=>3.618;stackAA[CA]=>4.684;stackAA[GA]=>4.836;stackAA[UA]=>3.457;stackAA[AC]=>5.076;stackAA[CC]=>6.117;stackAA[GC]=>3.014;stackAA[UC]=>4.319;stackAA[AG]=>3.839;stackAA[CG]=>3.209;stackAA[GG]=>5.579;stackAA[UG]=>4.056;stackAA[AU]=>3.312;stackAA[CU]=>5.153;stackAA[GU]=>3.707;stackAA[UU]=>3.806;stackCA[AA]=>4.714;stackCA[CA]=>3.892;stackCA[GA]=>4.631;stackCA[UA]=>2.864;stackCA[AC]=>4.629;stackCA[CC]=>5.800;stackCA[GC]=>2.993;stackCA[UC]=>4.401;stackCA[AG]=>4.881;stackCA[CG]=>2.615;stackCA[GG]=>5.079;stackCA[UG]=>3.813;stackCA[AU]=>3.778;stackCA[CU]=>5.491;stackCA[GU]=>4.313;stackCA[UU]=>4.554;stackGA[AA]=>4.518;stackGA[CA]=>4.973;stackGA[GA]=>4.595;stackGA[UA]=>3.357;stackGA[AC]=>4.220;stackGA[CC]=>4.970;stackGA[GC]=>3.010;stackGA[UC]=>5.529;stackGA[AG]=>3.941;stackGA[CG]=>2.808;stackGA[GG]=>5.068;stackGA[UG]=>3.919;stackGA[AU]=>3.024;stackGA[CU]=>5.248;stackGA[GU]=>3.927;stackGA[UU]=>4.812;stackUA[AA]=>6.885;stackUA[CA]=>6.768;stackUA[GA]=>5.757;stackUA[UA]=>2.405;stackUA[AC]=>7.358;stackUA[CC]=>7.784;stackUA[GC]=>1.849;stackUA[UC]=>7.152;stackUA[AG]=>7.368;stackUA[CG]=>2.237;stackUA[GG]=>6.397;stackUA[UG]=>4.263;stackUA[AU]=>2.817;stackUA[CU]=>8.407;stackUA[GU]=>4.689;stackUA[UU]=>6.114;stackAC[AA]=>5.459;stackAC[CA]=>5.772;stackAC[GA]=>4.224;stackAC[UA]=>4.645;stackAC[AC]=>4.622;stackAC[CC]=>5.514;stackAC[GC]=>2.151;stackAC[UC]=>5.261;stackAC[AG]=>5.562;stackAC[CG]=>3.546;stackAC[GG]=>3.810;stackAC[UG]=>4.419;stackAC[AU]=>3.556;stackAC[CU]=>6.567;stackAC[GU]=>2.355;stackAC[UU]=>4.789;stackCC[AA]=>4.401;stackCC[CA]=>5.489;stackCC[GA]=>4.085;stackCC[UA]=>3.830;stackCC[AC]=>4.290;stackCC[CC]=>4.726;stackCC[GC]=>2.875;stackCC[UC]=>4.938;stackCC[AG]=>4.243;stackCC[CG]=>2.955;stackCC[GG]=>3.865;stackCC[UG]=>3.545;stackCC[AU]=>3.745;stackCC[CU]=>5.704;stackCC[GU]=>3.603;stackCC[UU]=>4.991;stackGC[AA]=>7.480;stackGC[CA]=>6.491;stackGC[GA]=>6.333;stackGC[UA]=>2.833;stackGC[AC]=>6.826;stackGC[CC]=>8.435;stackGC[GC]=>1.647;stackGC[UC]=>6.723;stackGC[AG]=>6.709;stackGC[CG]=>2.204;stackGC[GG]=>5.716;stackGC[UG]=>4.359;stackGC[AU]=>2.882;stackGC[CU]=>7.037;stackGC[GU]=>4.501;stackGC[UU]=>6.848;stackUC[AA]=>3.758;stackUC[CA]=>4.103;stackUC[GA]=>3.980;stackUC[UA]=>3.472;stackUC[AC]=>6.132;stackUC[CC]=>5.916;stackUC[GC]=>2.304;stackUC[UC]=>4.569;stackUC[AG]=>4.752;stackUC[CG]=>3.056;stackUC[GG]=>3.514;stackUC[UG]=>5.429;stackUC[AU]=>5.034;stackUC[CU]=>6.253;stackUC[GU]=>3.242;stackUC[UU]=>5.519;stackAG[AA]=>3.974;stackAG[CA]=>4.888;stackAG[GA]=>5.009;stackAG[UA]=>3.500;stackAG[AC]=>5.562;stackAG[CC]=>4.040;stackAG[GC]=>2.658;stackAG[UC]=>5.302;stackAG[AG]=>4.415;stackAG[CG]=>3.015;stackAG[GG]=>5.315;stackAG[UG]=>4.888;stackAG[AU]=>3.478;stackAG[CU]=>3.435;stackAG[GU]=>4.205;stackAG[UU]=>4.270;stackCG[AA]=>6.691;stackCG[CA]=>6.940;stackCG[GA]=>6.974;stackCG[UA]=>2.436;stackCG[AC]=>7.431;stackCG[CC]=>7.983;stackCG[GC]=>2.337;stackCG[UC]=>7.549;stackCG[AG]=>7.112;stackCG[CG]=>1.692;stackCG[GG]=>7.997;stackCG[UG]=>3.561;stackCG[AU]=>2.884;stackCG[CU]=>7.729;stackCG[GU]=>5.478;stackCG[UU]=>6.852;stackGG[AA]=>4.835;stackGG[CA]=>4.276;stackGG[GA]=>3.935;stackGG[UA]=>3.271;stackGG[AC]=>5.098;stackGG[CC]=>4.148;stackGG[GC]=>2.820;stackGG[UC]=>4.145;stackGG[AG]=>5.204;stackGG[CG]=>2.995;stackGG[GG]=>4.417;stackGG[UG]=>4.706;stackGG[AU]=>3.354;stackGG[CU]=>4.144;stackGG[GU]=>4.923;stackGG[UU]=>4.793;stackUG[AA]=>5.675;stackUG[CA]=>5.938;stackUG[GA]=>5.518;stackUG[UA]=>3.179;stackUG[AC]=>7.220;stackUG[CC]=>5.186;stackUG[GC]=>2.388;stackUG[UC]=>5.644;stackUG[AG]=>7.132;stackUG[CG]=>2.270;stackUG[GG]=>6.947;stackUG[UG]=>3.872;stackUG[AU]=>3.272;stackUG[CU]=>5.558;stackUG[GU]=>2.756;stackUG[UU]=>5.424;stackAU[AA]=>6.567;stackAU[CA]=>7.824;stackAU[GA]=>6.678;stackAU[UA]=>2.596;stackAU[AC]=>6.072;stackAU[CC]=>8.390;stackAU[GC]=>1.722;stackAU[UC]=>8.273;stackAU[AG]=>6.683;stackAU[CG]=>2.559;stackAU[GG]=>7.335;stackAU[UG]=>4.180;stackAU[AU]=>2.524;stackAU[CU]=>7.257;stackAU[GU]=>4.418;stackAU[UU]=>5.799;stackCU[AA]=>4.390;stackCU[CA]=>5.037;stackCU[GA]=>4.549;stackCU[UA]=>3.198;stackCU[AC]=>4.407;stackCU[CC]=>5.904;stackCU[GC]=>3.013;stackCU[UC]=>4.993;stackCU[AG]=>3.365;stackCU[CG]=>3.562;stackCU[GG]=>3.918;stackCU[UG]=>2.914;stackCU[AU]=>3.726;stackCU[CU]=>5.470;stackCU[GU]=>4.571;stackCU[UU]=>5.032;stackGU[AA]=>5.302;stackGU[CA]=>7.627;stackGU[GA]=>7.652;stackGU[UA]=>2.996;stackGU[AC]=>5.119;stackGU[CC]=>6.842;stackGU[GC]=>2.066;stackGU[UC]=>6.860;stackGU[AG]=>5.313;stackGU[CG]=>1.868;stackGU[GG]=>6.097;stackGU[UG]=>4.824;stackGU[AU]=>2.879;stackGU[CU]=>6.187;stackGU[GU]=>4.556;stackGU[UU]=>6.224;stackUU[AA]=>4.796;stackUU[CA]=>4.945;stackUU[GA]=>5.058;stackUU[UA]=>3.061;stackUU[AC]=>4.513;stackUU[CC]=>5.943;stackUU[GC]=>2.887;stackUU[UC]=>5.583;stackUU[AG]=>4.558;stackUU[CG]=>3.212;stackUU[GG]=>4.712;stackUU[UG]=>4.621;stackUU[AU]=>3.103;stackUU[CU]=>4.662;stackUU[GU]=>3.874;stackUU[UU]=>3.148;", true, true);
}

void Stemloc_defaults::init_flat_params (Telegraph_PScores_adaptor& tgio)
{
  Dirichlet_prior prior (tgio.pscores);
  for_const_contents (set<int>, tgio.io_groups, g)
    prior.assign_Laplace (PGroup (*g, tgio.pscores.group_size (*g)), 1.);
  prior.initialise();
}

Stemloc_gramset::Stemloc_gramset (bool fix_group_suffix_now)
{
  // single SCFG

  Super_stem super_stem (single_scfg_pscores);
  single_scfg = super_stem;

  for (int g = 0; g < single_scfg_pscores.groups(); ++g)
    single_scfg_mutable_pgroups.insert (g);

  Telegraph_PScores_adaptor ss_tgio (single_scfg_pscores);
  Stemloc_defaults::init_superstem_params (ss_tgio);

  single_scfg_prior.assign_Laplace (single_scfg_pscores, STEMLOC_DEFAULT_DIRICHLET_PSEUDOCOUNT);

  for (int n = 1; n <= N_CMP_PARAMS; ++n)
    {
      PHMM_CFG phmm_cfg;

      // pair HMM

      Alphabet_group hmm_null_emit = phmm_cfg.hmm_pscores.new_alphabet_group (CFG_alphabet, "NullEmit");
      phmm_cfg.hmm_null_emit = hmm_null_emit;

      Quick_align quick_align (phmm_cfg.hmm_pscores, hmm_null_emit);
      quick_align.name << '_' << n;
      phmm_cfg.hmm = quick_align;
      phmm_cfg.hmm_mutable_pgroups = quick_align.mutable_pgroups;

      phmm_cfg.hmm_prior.assign_Laplace (phmm_cfg.hmm_pscores, phmm_cfg.hmm_mutable_pgroups, STEMLOC_DEFAULT_DIRICHLET_PSEUDOCOUNT);

      // hacky patch to make the param names match the Stemloc_defaults
      if (n > 1)
	for_contents (vector<sstring>, phmm_cfg.hmm_pscores.group_name, gn)
	  if (gn->size())
	    *gn << n;

      Telegraph_PScores_adaptor qa_tgio (phmm_cfg.hmm_pscores);
      Stemloc_defaults::init_quickalign_params (qa_tgio);

      set<int> non_pad_states = quick_align.non_pad_states();
      for (int s = 0; s < quick_align.states(); ++s)
	if (non_pad_states.find (s) == non_pad_states.end())
	  phmm_cfg.hmm_pad_states.insert (s);

      // pair SCFG

      Super_pair super_pair (&phmm_cfg.cfg_pscores);
      super_pair.name << '_' << n;
      phmm_cfg.cfg = super_pair;

      for (int g = 0; g < phmm_cfg.cfg_pscores.groups(); ++g)
	phmm_cfg.cfg_mutable_pgroups.insert (g);

      phmm_cfg.cfg_prior.assign_Laplace (phmm_cfg.cfg_pscores, STEMLOC_DEFAULT_DIRICHLET_PSEUDOCOUNT);

      // hacky patch to make the param names match the Stemloc_defaults
      if (n > 1)
	for_contents (vector<sstring>, phmm_cfg.cfg_pscores.group_name, gn)
	  if (gn->size())
	    *gn << n;

      Telegraph_PScores_adaptor sp_tgio (phmm_cfg.cfg_pscores);
      Stemloc_defaults::init_superpair_params (sp_tgio);

      // put it in the map

      sstring name;
      name << n;

      phmm_cfg_map[name] = phmm_cfg;
    }

  if (fix_group_suffix_now)
    fix_group_suffix();
}

void Stemloc_gramset::fix_group_suffix()
{
  fix_gs (single_scfg_pscores);
  for_contents (PHMM_CFG_map, phmm_cfg_map, name_phmm_cfg)
    {
      PHMM_CFG& phmm_cfg = name_phmm_cfg->second;
      fix_gs (phmm_cfg.hmm_pscores);
      fix_gs (phmm_cfg.cfg_pscores);
    }
}

void Stemloc_gramset::fix_gs (PScores& pscores)
{
  vector<vector<sstring> > new_gs;
  for (int g = 0; g < pscores.groups(); ++g)
    {
      vector<sstring> new_gs_vec (pscores.group_size (g));
      for (int v = 0; v < pscores.group_size(g); ++v)
	{
	  sstring gs;
	  if ((int) pscores.group_name.size() > g)
	    gs << pscores.group_name[g];
	  if ((int) pscores.group_suffix.size() > g && (int) pscores.group_suffix[g].size() > v)
	    gs << pscores.group_suffix[g][v];
	  else
	    gs << (v + 1);
	  new_gs_vec[v] = gs;
	}
      new_gs.push_back (new_gs_vec);
    }
  pscores.group_suffix.swap (new_gs);
}

void Stemloc_gramset::prefix_comments (ostream& out)
{
  out << ";; Note on model format:\n"
      << ";; The Pair-HMM parameters '" << STEMLOC_LOCAL << "' and '" << STEMLOC_GLOBAL << "' are set directly by stemloc,\n"
      << ";; via the command-line options --local and --global.\n";
}
